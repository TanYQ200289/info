var t=Object.defineProperty,e=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(e,s,o)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[s]=o;import{o as i,c as a,w as l,a as r,p as u,m as c,b as d,e as h,i as p,J as f,G as m,j as g,k as b,K as y,t as v,F as _,L as w,M as x,z as S,u as k,H as C,N as T,n as $,P as D,r as X,d as V,f as F}from"./index.37bf5aad.js";import{_ as W}from"./plugin-vue_export-helper.21dcd24c.js";import{a as O,r as P}from"./uni-app.es.d259472c.js";import{_ as Y}from"./uni-icons.a5cd0d6a.js";import{_ as A,a as B}from"./u-modal.8a1fb3ad.js";import{u as j}from"./shopCar.c2d79220.js";import{u as I}from"./index.675729df.js";import"./u-icon.f076fea3.js";var M=W({name:"UniNumberBox",emits:["change","input","update:modelValue","blur","focus"],props:{value:{type:[Number,String],default:1},modelValue:{type:[Number,String],default:1},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},background:{type:String,default:"#f5f5f5"},color:{type:String,default:"#333"},disabled:{type:Boolean,default:!1}},data:()=>({inputValue:0}),watch:{value(t){this.inputValue=+t},modelValue(t){this.inputValue=+t}},created(){1===this.value&&(this.inputValue=+this.modelValue),1===this.modelValue&&(this.inputValue=+this.value)},methods:{_calcValue(t){if(this.disabled)return;const e=this._getDecimalScale();let s=this.inputValue*e,o=this.step*e;if("minus"===t){if(s-=o,s<this.min*e)return;s>this.max*e&&(s=this.max*e)}if("plus"===t){if(s+=o,s>this.max*e)return;s<this.min*e&&(s=this.min*e)}this.inputValue=(s/e).toFixed(String(e).length-1),this.$emit("change",+this.inputValue),this.$emit("input",+this.inputValue),this.$emit("update:modelValue",+this.inputValue)},_getDecimalScale(){let t=1;return~~this.step!==this.step&&(t=Math.pow(10,String(this.step).split(".")[1].length)),t},_onBlur(t){this.$emit("blur",t);let e=t.detail.value;if(!e)return;e=+e,e>this.max?e=this.max:e<this.min&&(e=this.min);const s=this._getDecimalScale();this.inputValue=e.toFixed(String(s).length-1),this.$emit("change",+this.inputValue),this.$emit("input",+this.inputValue)},_onFocus(t){this.$emit("focus",t)}}},[["render",function(t,e,s,o,n,m){const g=h,b=p,y=f;return i(),a(b,{class:"uni-numbox"},{default:l((()=>[r(b,{onClick:e[0]||(e[0]=t=>m._calcValue("minus")),class:"uni-numbox__minus uni-numbox-btns",style:c({background:s.background})},{default:l((()=>[r(g,{class:u(["uni-numbox--text",{"uni-numbox--disabled":n.inputValue<=s.min||s.disabled}]),style:c({color:s.color})},{default:l((()=>[d("-")])),_:1},8,["class","style"])])),_:1},8,["style"]),r(y,{disabled:s.disabled,onFocus:m._onFocus,onBlur:m._onBlur,class:"uni-numbox__value",type:"number",modelValue:n.inputValue,"onUpdate:modelValue":e[1]||(e[1]=t=>n.inputValue=t),style:c({background:s.background,color:s.color})},null,8,["disabled","onFocus","onBlur","modelValue","style"]),r(b,{onClick:e[2]||(e[2]=t=>m._calcValue("plus")),class:"uni-numbox__plus uni-numbox-btns",style:c({background:s.background})},{default:l((()=>[r(g,{class:u(["uni-numbox--text",{"uni-numbox--disabled":n.inputValue>=s.max||s.disabled}]),style:c({color:s.color})},{default:l((()=>[d("+")])),_:1},8,["class","style"])])),_:1},8,["style"])])),_:1})}],["__scopeId","data-v-c8168ffa"]]);let N={},z=null;z=function(){var t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],s=!0;for(let o=0;o<e.length-1;o++)if(t.indexOf(e[o])>0){s=!1;break}return s}(),N={data:()=>({is_show:"none"}),watch:{show(t){this.is_show=this.show}},created(){this.swipeaction=this.getSwipeAction(),void 0!==this.swipeaction.children&&this.swipeaction.children.push(this)},mounted(){this.is_show=this.show},methods:{closeSwipe(t){this.autoClose&&this.swipeaction.closeOther(this)},change(t){this.$emit("change",t.open),this.is_show!==t.open&&(this.is_show=t.open)},appTouchStart(t){if(z)return;const{clientX:e}=t.changedTouches[0];this.clientX=e,this.timestamp=(new Date).getTime()},appTouchEnd(t,e,s,o){if(z)return;const{clientX:n}=t.changedTouches[0];let i=Math.abs(this.clientX-n),a=(new Date).getTime()-this.timestamp;i<40&&a<300&&this.$emit("click",{content:s,index:e,position:o})},onClickForPC(t,e,s){z&&this.$emit("click",{content:e,index:t,position:s})}}};var q=!1;function E(t,e){var s=t.instance,o=s.getDataset().disabled,n=s.getState();H(s,e),(o=("string"==typeof o?JSON.parse(o):o)||!1)||(s.requestAnimationFrame((function(){s.removeClass("ani"),e.callMethod("closeSwipe")})),n.x=n.left||0,function(t){var e=t.instance,s=e.getState();R(e);var o=t.touches[0];q&&K()&&(o=t);s.startX=o.clientX,s.startY=o.clientY}(t))}function J(t,e){var s=t.instance,o=s.getDataset().disabled,n=s.getState();(o=("string"==typeof o?JSON.parse(o):o)||!1)||(!function(t){var e=t.instance.getState(),s=t.touches[0];q&&K()&&(s=t);e.deltaX=s.clientX-e.startX,e.deltaY=s.clientY-e.startY,e.offsetY=Math.abs(e.deltaY),e.offsetX=Math.abs(e.deltaX),e.direction=e.direction||function(t,e){if(t>e&&t>10)return"horizontal";if(e>t&&e>10)return"vertical";return""}(e.offsetX,e.offsetY)}(t),"horizontal"===n.direction&&(t.preventDefault&&t.preventDefault(),G(n.x+n.deltaX,s)))}function U(t,e){var s=t.instance,o=s.getDataset().disabled,n=s.getState();(o=("string"==typeof o?JSON.parse(o):o)||!1)||function(t,e,s){var o=e.getState(),n=o.threshold;o.position;var i=o.isopen||"none",a=o.leftWidth,l=o.rightWidth;if(0===o.deltaX)return void L("none",e,s);L("none"===i&&l>0&&-t>n||"none"!==i&&l>0&&l+t<n?"right":"none"===i&&a>0&&t>n||"none"!==i&&a>0&&a-t<n?"left":"none",e,s)}(n.left,s,e)}function G(t,e,s){t=t||0;var o,n,i,a=e.getState(),l=a.leftWidth,r=a.rightWidth;a.left=(o=t,n=-r,i=l,Math.min(Math.max(o,n),i)),e.requestAnimationFrame((function(){e.setStyle({transform:"translateX("+a.left+"px)","-webkit-transform":"translateX("+a.left+"px)"})}))}function H(t,e){var s,o,n=t.getState(),i=e.selectComponent(".button-group--left"),a=e.selectComponent(".button-group--right");s=i.getBoundingClientRect(),o=a.getBoundingClientRect(),n.leftWidth=s.width||0,n.rightWidth=o.width||0,n.threshold=t.getDataset().threshold}function L(t,e,s){var o=e.getState(),n=o.leftWidth,i=o.rightWidth,a="";switch(o.isopen=o.isopen?o.isopen:"none",t){case"left":a=n;break;case"right":a=-i;break;default:a=0}o.isopen!==t&&(o.throttle=!0,s.callMethod("change",{open:t})),o.isopen=t,e.requestAnimationFrame((function(){e.addClass("ani"),G(a,e)}))}function R(t){var e=t.getState();e.direction="",e.deltaX=0,e.deltaY=0,e.offsetX=0,e.offsetY=0}function K(){for(var t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],s=!0,o=0;o<e.length-1;o++)if(t.indexOf(e[o])>0){s=!1;break}return s}"object"==typeof window&&(q=!0);var Q=!1;const Z={showWatch:function(t,e,s,o){var n=o.getState();H(o,s),t&&"none"!==t?L(t,o,s):(n.left&&L("none",o,s),R(o))},touchstart:E,touchmove:J,touchend:U,mousedown:function(t,e){q&&K()&&(E(t,e),Q=!0)},mousemove:function(t,e){q&&K()&&Q&&J(t)},mouseup:function(t,e){q&&K()&&(U(t,e),Q=!1)},mouseleave:function(t,e){q&&K()&&(Q=!1)}};var tt=t=>{t.$wxs||(t.$wxs=[]),t.$wxs.push("wxsswipe"),t.mixins||(t.mixins=[]),t.mixins.push({beforeCreate(){this.wxsswipe=Z}})};var et={showWatch(t,e,s,o,n){var i=n.state;(s.$el||s.$vm&&s.$vm.$el)&&(this.getDom(o,s,n),t&&"none"!==t?this.openState(t,o,s,n):(i.left&&this.openState("none",o,s,n),this.resetTouchStatus(o,n)))},touchstart(t,e,s){let o=t.instance,n=o.getDataset().disabled,i=s.state;this.getDom(o,e,s),n=this.getDisabledType(n),n||(o.requestAnimationFrame((function(){o.removeClass("ani"),e.callMethod("closeSwipe")})),i.x=i.left||0,this.stopTouchStart(t,e,s))},touchmove(t,e,s){let o=t.instance;if(!o)return;let n=o.getDataset().disabled,i=s.state;if(n=this.getDisabledType(n),n)return;if(this.stopTouchMove(t,s),"horizontal"!==i.direction)return;t.preventDefault&&t.preventDefault();let a=i.x+i.deltaX;this.move(a,o,e,s)},touchend(t,e,s){let o=t.instance,n=o.getDataset().disabled,i=s.state;n=this.getDisabledType(n),n||this.moveDirection(i.left,o,e,s)},move(t,e,s,o){t=t||0;let n=o.state,i=n.leftWidth,a=n.rightWidth;n.left=this.range(t,-a,i),e.requestAnimationFrame((function(){e.setStyle({transform:"translateX("+n.left+"px)","-webkit-transform":"translateX("+n.left+"px)"})}))},getDom(t,e,s){var o=s.state,n=e.$el||e.$vm&&e.$vm.$el,i=n.querySelector(".button-group--left"),a=n.querySelector(".button-group--right");o.leftWidth=i.offsetWidth||0,o.rightWidth=a.offsetWidth||0,o.threshold=t.getDataset().threshold},getDisabledType:t=>("string"==typeof t?JSON.parse(t):t)||!1,range:(t,e,s)=>Math.min(Math.max(t,e),s),moveDirection(t,e,s,o){var n=o.state,i=n.threshold;n.position;var a=n.isopen||"none",l=n.leftWidth,r=n.rightWidth;0!==n.deltaX?"none"===a&&r>0&&-t>i||"none"!==a&&r>0&&r+t<i?this.openState("right",e,s,o):"none"===a&&l>0&&t>i||"none"!==a&&l>0&&l-t<i?this.openState("left",e,s,o):this.openState("none",e,s,o):this.openState("none",e,s,o)},openState(t,e,s,o){let n=o.state,i=n.leftWidth,a=n.rightWidth,l="";switch(n.isopen=n.isopen?n.isopen:"none",t){case"left":l=i;break;case"right":l=-a;break;default:l=0}n.isopen!==t&&(n.throttle=!0,s.callMethod("change",{open:t})),n.isopen=t,e.requestAnimationFrame((()=>{e.addClass("ani"),this.move(l,e,s,o)}))},getDirection:(t,e)=>t>e&&t>10?"horizontal":e>t&&e>10?"vertical":"",resetTouchStatus(t,e){let s=e.state;s.direction="",s.deltaX=0,s.deltaY=0,s.offsetX=0,s.offsetY=0},stopTouchStart(t,e,s){let o=t.instance,n=s.state;this.resetTouchStatus(o,s);var i=t.touches[0];n.startX=i.clientX,n.startY=i.clientY},stopTouchMove(t,e){t.instance;let s=e.state,o=t.touches[0];s.deltaX=o.clientX-s.startX,s.deltaY=o.clientY-s.startY,s.offsetY=Math.abs(s.deltaY),s.offsetX=Math.abs(s.deltaX),s.direction=s.direction||this.getDirection(s.offsetX,s.offsetY)}};const st={mounted(t,e,s){this.state={}},methods:{showWatch(t,e,s,o){et.showWatch(t,e,s,o,this)},touchstart(t,e){et.touchstart(t,e,this)},touchmove(t,e){et.touchmove(t,e,this)},touchend(t,e){et.touchend(t,e,this)}}};var ot=t=>{t.$renderjs||(t.$renderjs=[]),t.$renderjs.push("renderswipe"),t.mixins||(t.mixins=[]),t.mixins.push({beforeCreate(){this.renderswipe=this},mounted(){this.$ownerInstance=this.$gcd(this,!0)}}),t.mixins.push(st)};const nt={mixins:[N,{},{}],emits:["click","change"],props:{show:{type:String,default:"none"},disabled:{type:Boolean,default:!1},autoClose:{type:Boolean,default:!0},threshold:{type:Number,default:20},leftOptions:{type:Array,default:()=>[]},rightOptions:{type:Array,default:()=>[]}},unmounted(){this.__isUnmounted=!0,this.uninstall()},methods:{uninstall(){this.swipeaction&&this.swipeaction.children.forEach(((t,e)=>{t===this&&this.swipeaction.children.splice(e,1)}))},getSwipeAction(t="uniSwipeAction"){let e=this.$parent,s=e.$options.name;for(;s!==t;){if(e=e.$parent,!e)return!1;s=e.$options.name}return e}}};tt(nt),ot(nt);var it=W(nt,[["render",function(t,e,s,o,n,u){const f=h,w=p;return i(),a(w,{class:"uni-swipe"},{default:l((()=>[r(w,{class:"uni-swipe_box","change:prop":t.wxsswipe.showWatch,prop:t.is_show,"data-threshold":s.threshold,"data-disabled":s.disabled,onTouchstart:t.wxsswipe.touchstart,onTouchmove:t.wxsswipe.touchmove,onTouchend:t.wxsswipe.touchend},{default:l((()=>[r(w,{class:"uni-swipe_button-group button-group--left"},{default:l((()=>[m(t.$slots,"left",{},(()=>[(i(!0),g(_,null,b(s.leftOptions,((e,s)=>(i(),a(w,{key:s,style:c({backgroundColor:e.style&&e.style.backgroundColor?e.style.backgroundColor:"#C7C6CD"}),class:"uni-swipe_button button-hock",onTouchstart:t.appTouchStart,onTouchend:o=>t.appTouchEnd(o,s,e,"left"),onClick:y((o=>t.onClickForPC(s,e,"left")),["stop"])},{default:l((()=>[r(f,{class:"uni-swipe_button-text",style:c({color:e.style&&e.style.color?e.style.color:"#FFFFFF",fontSize:e.style&&e.style.fontSize?e.style.fontSize:"16px"})},{default:l((()=>[d(v(e.text),1)])),_:2},1032,["style"])])),_:2},1032,["style","onTouchstart","onTouchend","onClick"])))),128))]),!0)])),_:3}),r(w,{class:"uni-swipe_text--center"},{default:l((()=>[m(t.$slots,"default",{},void 0,!0)])),_:3}),r(w,{class:"uni-swipe_button-group button-group--right"},{default:l((()=>[m(t.$slots,"right",{},(()=>[(i(!0),g(_,null,b(s.rightOptions,((e,s)=>(i(),a(w,{key:s,style:c({backgroundColor:e.style&&e.style.backgroundColor?e.style.backgroundColor:"#C7C6CD"}),class:"uni-swipe_button button-hock",onTouchstart:t.appTouchStart,onTouchend:o=>t.appTouchEnd(o,s,e,"right"),onClick:y((o=>t.onClickForPC(s,e,"right")),["stop"])},{default:l((()=>[r(f,{class:"uni-swipe_button-text",style:c({color:e.style&&e.style.color?e.style.color:"#FFFFFF",fontSize:e.style&&e.style.fontSize?e.style.fontSize:"16px"})},{default:l((()=>[d(v(e.text),1)])),_:2},1032,["style"])])),_:2},1032,["style","onTouchstart","onTouchend","onClick"])))),128))]),!0)])),_:3})])),_:3},8,["change:prop","prop","data-threshold","data-disabled","onTouchstart","onTouchmove","onTouchend"])])),_:3})}],["__scopeId","data-v-54d270ed"]]);var at=W({name:"uniSwipeAction",data:()=>({}),created(){this.children=[]},methods:{resize(){},closeAll(){this.children.forEach((t=>{t.is_show="none"}))},closeOther(t){this.openItem&&this.openItem!==t&&(this.openItem.is_show="none"),this.openItem=t}}},[["render",function(t,e,s,o,n,r){const u=p;return i(),a(u,null,{default:l((()=>[m(t.$slots,"default")])),_:3})}]]);var lt=W({__name:"shoppingCart",setup(t){const u=S(!1),c=function(){const t=j();return{setTabBarBadge:function(){setTimeout((()=>{const e=t.countCarNumber;e?w({index:2,text:e+""}):(w({index:2,text:"0"}),x({index:2}))}),200)}}}(),f=[{text:"取消",style:{backgroundColor:"orange"}},{text:"删除",style:{backgroundColor:"#dd524d"}}],m=I(),y=j();function W(){m.userInfo.uid?T({url:"/pages/classify/classify"}):$({url:"/subPages/Login/Login"})}function N(){const t=!y.isAllcheckedGoods;y.car.forEach((e=>{e.done=t}))}function z(t,{index:e}){if(e){const e=y.car.findIndex((e=>e===t));-1!==e&&(y.car.splice(e,1),async function(t){await uni.Http(`/card/deleteCard/${t}/${m.userInfo.uid}`,"get")}(t.gid),c.setTabBarBadge())}}return O((()=>{m.userInfo.uid&&(y.car=[],async function(){const{data:t}=await uni.Http(`/card/queryUserCard/${m.userInfo.uid}`,"get"),i=t.map((t=>((t,i)=>{for(var a in i||(i={}))s.call(i,a)&&n(t,a,i[a]);if(e)for(var a of e(i))o.call(i,a)&&n(t,a,i[a]);return t})({done:!1},t)));y.car.push(...i)}(),c.setTabBarBadge())})),(t,e)=>{const s=h,o=p,n=D,w=F,x=P(X("uni-number-box"),M),S=P(X("uni-swipe-action-item"),it),T=P(X("uni-swipe-action"),at),O=P(X("uni-icons"),Y),j=P(X("u-loading-icon"),A),I=P(X("u-modal"),B);return i(),a(o,{class:"content"},{default:l((()=>[r(o,{class:"count-edit"},{default:l((()=>[r(s,null,{default:l((()=>[d("共"),r(s,{style:{color:"red"}},{default:l((()=>[d(v(k(y).countCarNumber?k(y).countCarNumber:0),1)])),_:1}),d("件商品")])),_:1})])),_:1}),k(y).countCarNumber?(i(),a(T,{key:0},{default:l((()=>[(i(!0),g(_,null,b(k(y).car,(t=>(i(),a(S,{key:t.gid,"right-options":f,onClick:e=>z(t,e)},{default:l((()=>[r(o,{class:"select-goods-card"},{default:l((()=>[r(o,{class:"select-goods-card-left"},{default:l((()=>[r(n,{checked:t.done,color:"orange",onClick:e=>{var s;(s=t).done=!s.done}},null,8,["checked","onClick"]),r(o,{class:"select-goods-card-left-image",onClick:e=>{return s=t.gid,void $({url:`/subPages/Details/Details?id=${s}`});var s}},{default:l((()=>[r(w,{class:"images",src:t.image.serverName+t.image.displayimg},null,8,["src"])])),_:2},1032,["onClick"])])),_:2},1024),r(o,{class:"select-goods-card-right"},{default:l((()=>[r(o,{class:"select-goods-card-right-title"},{default:l((()=>[d(v(t.message),1)])),_:2},1024),r(o,{class:"select-goods-card-right-mark"},{default:l((()=>[(i(),g(_,null,b(2,(t=>r(s,null,{default:l((()=>[d("深空灰色")])),_:1}))),64))])),_:1}),V("div",{class:"select-goods-card-right-bottom"},[r(o,{style:{color:"red"}},{default:l((()=>[d("￥"+v(t.price),1)])),_:2},1024),r(x,{class:"number-box",min:1,max:99,value:t.goodscount,onChange:e=>function(t,e){const s=y.car.findIndex((e=>e.gid===t));y.car[s].goodscount=e,c.setTabBarBadge()}(t.gid,e)},null,8,["value","onChange"])])])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):k(m).userInfo.uid?(i(),a(o,{key:2},{default:l((()=>[r(j)])),_:1})):(i(),a(o,{key:1,class:"shopping-Car-empty-container"},{default:l((()=>[r(O,{type:"cart",size:"100",color:"silver"}),r(o,{style:{color:"silver",margin:"20rpx"}},{default:l((()=>[d("你的购物车是空的，快去逛逛吧")])),_:1}),r(o,{class:"shopping-car-button",onClick:W},{default:l((()=>[d(" 去逛逛 ")])),_:1})])),_:1})),k(m).userInfo.uid?(i(),a(o,{key:3},{default:l((()=>[r(o,{class:"shopping-footer"},{default:l((()=>[r(o,{class:"shopping-footer-all"},{default:l((()=>[r(n,{value:"r2",onClick:N,checked:k(y).isAllcheckedGoods,color:"orange"},null,8,["checked"]),d(" 全选 ")])),_:1}),r(o,{class:"shopping-footer-counter"},{default:l((()=>[d(v(k(y).countPrice?"合计:":""),1),r(s,{style:{color:"red"}},{default:l((()=>[d(v(k(y).countPrice?`￥${k(y).countPrice}`:""),1)])),_:1})])),_:1}),r(o,{class:"shopping-footer-pay-button",onClick:e[0]||(e[0]=t=>u.value=!u.value)},{default:l((()=>[d("去结算")])),_:1})])),_:1})])),_:1})):C("",!0),r(I,{show:u.value,title:"警告",content:"该网站为演示项目无法下单",onConfirm:e[1]||(e[1]=t=>u.value=!u.value)},null,8,["show"])])),_:1})}}},[["__scopeId","data-v-19dae777"]]);export{lt as default};
